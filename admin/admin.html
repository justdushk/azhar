<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Panel - Universal CMS</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <div class="admin-layout">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <h2>‚ö° Admin Panel</h2>
      </div>
      
      <nav>
        <ul class="sidebar-nav">
          <li><a href="#dashboard" data-route="dashboard" class="active">üìä Dashboard</a></li>
          <li><a href="#navigation" data-route="navigation">üß≠ –ù–∞–≤–∏–≥–∞—Ü–∏—è</a></li>
          <li><a href="#pages" data-route="pages">üìÑ –°—Ç—Ä–∞–Ω–∏—Ü—ã</a></li>
          <li><a href="#sections" data-route="sections">üì¶ –°–µ–∫—Ü–∏–∏</a></li>
        </ul>
      </nav>
      
      <div class="sidebar-footer">
        <button id="logout-btn" class="btn btn-secondary" style="width: 100%;">–í—ã—Ö–æ–¥</button>
      </div>
    </aside>
    
    <!-- Main Content -->
    <main class="main-content">
      <!-- Dashboard View -->
      <div id="dashboard-view" class="view">
        <div class="content-header">
          <h1>Dashboard</h1>
        </div>
        <div id="dashboard-stats"></div>
      </div>
      
      <!-- Navigation View -->
      <div id="navigation-view" class="view">
        <div class="content-header">
          <h1>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π</h1>
          <button id="add-nav-item" class="btn btn-primary">+ –î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç</button>
        </div>
        <div id="navigation-list"></div>
      </div>
      
      <!-- Pages View -->
      <div id="pages-view" class="view">
        <div class="content-header">
          <h1>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏</h1>
          <button id="add-page" class="btn btn-primary">+ –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É</button>
        </div>
        <div id="pages-list"></div>
      </div>
      
      <!-- Sections View -->
      <div id="sections-view" class="view">
        <div class="content-header">
          <h1>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ü–∏—è–º–∏</h1>
          <button id="add-section" class="btn btn-primary">+ –î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏—é</button>
        </div>
        <div id="sections-list"></div>
      </div>
    </main>
  </div>

  <!-- Load Supabase from CDN -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  
  <!-- Load Config -->
  <script src="config.js"></script>
  
  <!-- Load Core Modules -->
  <script src="js/core/auth.js"></script>
  <script src="js/core/supabase.js"></script>
  <script src="js/core/router.js"></script>
  <script src="js/core/ui.js"></script>
  <script src="js/core/table.js"></script>
  <script src="js/core/form.js"></script>
  
  <!-- Load Feature Modules -->
  <script src="js/modules/dashboard.js"></script>
  <script src="js/modules/navigation.js"></script>
  <script src="js/modules/pages.js"></script>
  <script src="js/modules/sections.js"></script>
  
  <!-- Initialize App -->
  <script>
    // Require authentication
    (async function() {
      const isAuth = await Auth.requireAuth();
      if (!isAuth) {
        // Will redirect to login
        return;
      }
      
      // Continue initialization
      // Initialize Supabase
      if (SupabaseService.init()) {
        console.log('‚úÖ Admin Panel initialized');
        
        // Initialize router
        Router.init();
      } else {
        document.body.innerHTML = `
          <div style="padding: 40px; text-align: center; max-width: 600px; margin: 0 auto;">
            <h1 style="color: #ef4444; margin-bottom: 20px;">‚ö†Ô∏è –û—à–∏–±–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Supabase</h1>
            <p style="margin-bottom: 15px;">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Supabase –≤ —Ñ–∞–π–ª–µ <code>config.js</code></p>
            
            <div style="background: #f8fafc; padding: 20px; border-radius: 8px; margin: 20px 0; text-align: left;">
              <h3 style="margin-top: 0;">–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:</h3>
              <ol style="line-height: 1.8;">
                <li>–°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –Ω–∞ <a href="https://supabase.com" target="_blank" style="color: #4f46e5;">supabase.com</a></li>
                <li>–í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –∏–∑ <code>admin/database-setup.sql</code></li>
                <li>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ Project URL –∏ anon key</li>
                <li>–í—Å—Ç–∞–≤—å—Ç–µ –≤ <code>admin/config.js</code></li>
              </ol>
            </div>
            
            <p style="color: #64748b; font-size: 14px;">
              –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É
            </p>
          </div>
        `;
      }
    })();
    
    // Logout handler
    document.getElementById('logout-btn').addEventListener('click', async () => {
      if (confirm('–í—ã–π—Ç–∏ –∏–∑ –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è?')) {
        await Auth.logout();
      }
    });
  </script>
</body>
</html>